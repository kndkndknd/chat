{"version":3,"sources":["webpack:///webpack/bootstrap 6ce5eeb34028ffe20a3a","webpack:///./src/module.js","webpack:///./src/client.js"],"names":["exports","keyDownFunc","keyCode","stringsClient","socket","keyMap","charCode","emit","charEmit","char","chunkEmit","data","toBase64","buffer","video","bufferContext","getContext","width","videoWidth","height","videoHeight","drawImage","toDataURL","textPrint","ctx","canvas","text","fillStyle","length","font","String","Math","floor","textAlign","textBaseline","fillText","restore","whitePrint","fillRect","ctrlView","statusList","HTML","clients","tableHTML","key","chatFrom","chatTo","recordFrom","playbackTo","timelapseTo","drumTo","silenceTo","secbeforeTo","status","toString","Object","prototype","call","rangeHTML","id","streamType","sampleRateHTML","gainHTML","substr","toUpperCase","statusPrint","oscGainValue","freqVal","feedbackGainValue","noiseGainValue","bassFlag","statusText","keycodeMap","keycode","modules","require","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","window","URL","webkitURL","mozURL","msURL","AudioContext","webkitAudioContext","mozAudioContext","msAudioContext","audioContext","masterGain","createGain","gainVal","gain","setTargetAtTime","master","prevGain","connect","destination","feedbackGain","filter","createBiquadFilter","type","frequency","javascriptnode","createScriptProcessor","streamBuffer","lookBackBuffer","bufferSize","bufferRate","osc","createOscillator","oscGain","oscPortament","start","bassOsc","bassGain","clickOsc","clickGain","whitenoise","whitenoiseNode","noiseGain","onaudioprocess","ev","buf0","outputBuffer","getChannelData","buf1","i","random","chatBuffer","chatGain","convolver","createConvolver","revGain","console","log","context","sampleRate","droneBuff","timelapseFlag","ssu","SpeechSynthesisUtterance","lang","voice","modList","chordList","chordChange","modChange","alertBuffer","alertPlay","src","createBufferSource","click","t0","currentTime","setValueAtTime","setTimeout","loadSample","url","req","XMLHttpRequest","open","responseType","onload","response","decodeAudioData","then","b","send","bassLine","bass","BASS","filterChange","returnValue","value","image","receive","receive_ctx","onAudioProcess","e","videoMode","mode","bufferData","Float32Array","inputBuffer","copyFromChannel","funcToBase64","option","push","beforeChunk","shift","playAudioStream","playVideo","undefined","droneflag","target","sendChunk","flo32arr","volume","glitch","audio_src","audioData","audio_buf","createBuffer","copyToChannel","bufferPlaying","onended","initialize","mediaDevices","audio","stream","mediastreamsource","createMediaStreamSource","document","getElementById","createObjectURL","play","renderStart","createElement","rhythmProperty","metronome","metronomeCount","startRhythm","interval","setInterval","score","timbre","stopRhythm","clearInterval","$","on","standAlone","isNaN","Number","doCmd","strings","speakVoice","addEventListener","sizing","resize","attr","render","requestAnimationFrame","client","rhythm","videoStop","streamList","uint8arr","toBuffer","chunkGain","playsampleRate","speechSynthesis","speak","cmd","NOISE","OSC","property","FEEDBACK","printText","eval","timeLapse","stopLapse","bpm","trig","pastPresent","stop","size","remove","addHTML","before","Image","wdth","hght","lapseInterval","setLapse","ctrlCmd","ctrlProperty","val","test","match","targetArr","split","prop"],"mappings":"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","file":"client.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6ce5eeb34028ffe20a3a","\nexports.keyDownFunc = function keyDownFunc(keyCode, stringsClient, socket){\n  const keyMap = {\n// const keycodeMap = {\n  '48' : '0',\n  '49' : '1',\n  '50' : '2',\n  '51' : '3',\n  '52' : '4',\n  '53' : '5',\n  '54' : '6',\n  '55' : '7',\n  '56' : '8',\n  '57' : '9',\n  '65' : 'A',\n  '66' : 'B',\n  '67' : 'C',\n  '68' : 'D',\n  '69' : 'E',\n  '70' : 'F',\n  '71' : 'G',\n  '72' : 'H',\n  '73' : 'I',\n  '74' : 'J',\n  '75' : 'K',\n  '76' : 'L',\n  '77' : 'M',\n  '78' : 'N',\n  '79' : 'O',\n  '80' : 'P',\n  '81' : 'Q',\n  '82' : 'R',\n  '83' : 'S',\n  '84' : 'T',\n  '85' : 'U',\n  '86' : 'V',\n  '87' : 'W',\n  '88' : 'X',\n  '89' : 'Y',\n  '90' : 'Z',\n  '8'  : 'backspace',\n  '13' : 'enter',\n  '16' : 'shift',\n  '17' : 'ctrl',\n  '36' : 'home',\n  '18' : 'alt',\n  '9' : 'tab',\n  '32' : ' ',\n  '107' : 'add',\n  '20' : 'caps_lock',\n  '27' : 'escape',\n  '37' : 'left_arrow',\n  '38' : 'up_arrow',\n  '39' : 'right_arrow',\n  '40' : 'down_arrow',\n  '112' : 'f1' ,\n  '113' : 'f2' ,\n  '114' : 'f3' ,\n  '115' : 'f4' ,\n  '116' : 'f5' ,\n  '117' : 'f6' ,\n  '118' : 'f7' ,\n  '119' : 'f8' ,\n  '120' : 'f9' ,\n  '121' : 'f10',\n  '122' : 'f11',\n  '123' : 'f12',\n  '188' : 'comma',\n  \"190\" : \".\",\n  \"189\" : \"_\",\n  \"226\" : \"_\",\n  \"220\" : \"_\"\n  };\n  let charCode = keyMap[keyCode];\n  if(charCode === \"left_arrow\" || charCode === \"backspace\" || charCode === \"escape\"){\n    stringsClient = \"\";\n  } else if(keyCode >= 48 && keyCode <= 90 || keyCode === 190 || keyCode === 189 || keyCode === 226 || keyCode === 32){\n    stringsClient = stringsClient + charCode;\n  }\n  socket.emit('charFromClient', keyCode);\n  return stringsClient;\n}\n\n\nexports.charEmit = function charEmit(char, socket){\n  socket.emit('charFromClient', char);\n}\n\nexports.chunkEmit = function chunkEmit(data, socket){\n  socket.emit('chunkFromClient', data);\n}\n\nexports.toBase64 = function toBase64(buffer, video){\n  let bufferContext = buffer.getContext('2d');\n  buffer.width = video.videoWidth;\n  buffer.height = video.videoHeight;\n  bufferContext.drawImage(video, 0, 0);\n  //return buffer.toDataURL(\"image/webp\");\n  return buffer.toDataURL(\"image/jpeg\");\n}\n\nexports.textPrint = function textPrint(ctx, canvas, text){\n  // console.log(\"text print\");\n  ctx.fillStyle = \"black\";\n  if(text.length > 2) {\n    ctx.font = \"bold \" + String(Math.floor((canvas.width * 4 / 3) / text.length)) + \"px 'Arial'\";\n  } else {\n    ctx.font = \"bold \" + String(Math.floor((canvas.height * 5 / 4) / text.length)) + \"px 'Arial'\";\n  }\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n  ctx.fillText(text, canvas.width / 2, canvas.height / 2);\n  ctx.restore();\n}\n\nexports.whitePrint = function whitePrint(ctx, canvas) {\n  ctx.fillStyle = \"white\";\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n}\n\nexports.ctrlView = function ctrlView(statusList){\n  let HTML = \"\";\n  let clients = statusList[\"clients\"];\n  let tableHTML = '<table border=\"1\" id=\"clientList\"><tr id=\"tr\"><th>client</th> <th>id</th> <th>room</th><th>CHAT_FROM</th> <th>CHAT_TO</th> <th>RECORD_FROM</th> <th>PLAYBACK_TO</th> <th>TIMELAPSE_TO</th> <th>DRUM_TO</th> <th>SILENCE_TO</th> <th>BEFORE_TO</th> <th>CHAT_RATE</th>';\n  for(let key in clients){\n    let chatFrom = \"\",\n        chatTo = \"\",\n        recordFrom = \"\",\n        playbackTo = \"\",\n        timelapseTo = \"\",\n        drumTo = \"\",\n        silenceTo = \"\",\n        secbeforeTo = \"\";\n    \n    for(let status in clients[key][\"STREAMS\"]){\n      let toString = Object.prototype.toString;\n      if(toString.call(clients[key][\"STREAMS\"][status]) === \"[object Object]\"){\n        if(\"FROM\" in clients[key][\"STREAMS\"][status] && clients[key][\"STREAMS\"][status][\"FROM\"]){\n          switch(status){\n            case \"CHAT\":\n              chatFrom = ' checked=\"checked\"';\n              break;\n            case \"RECORD\":\n              recordFrom = ' checked=\"checked\"';\n              break;\n          }\n        }\n        if(\"TO\" in clients[key][\"STREAMS\"][status] && clients[key][\"STREAMS\"][status][\"TO\"]){\n          switch(status){\n            case \"CHAT\":\n              chatTo = ' checked=\"checked\"';\n              break;\n            case \"PLAYBACK\":\n              playbackTo = ' checked=\"checked\"';\n              break;\n            case \"TIMELAPSE\":\n              timelapseTo = ' checked=\"checked\"';\n              break;\n            case \"DRUM\":\n              drumTo = ' checked=\"checked\"';\n              break;\n            case \"SILENCE\":\n              silenceTo = ' checked=\"checked\"';\n              break;\n            case \"SECBEFORE\":\n              secbeforeTo = ' checked=\"checked\"';\n              break;\n          }\n        }\n      }\n    }\n    tableHTML = tableHTML + '<tr id=\"clientTd\"><td>'+ clients[key][\"type\"] + '</td><td id=\"IdTd\">' + clients[key][\"No\"] + '</td><td>' + clients[key][\"room\"] + '</td><td><input type=\"checkbox\" id=\"CHAT_FROM\" class=\"route\" name=\"' + key\n    + '\"' + chatFrom + '></td><td><input type=\"checkbox\" id=\"CHAT_TO\" class=\"route\" name=\"' + key + '\"' + chatTo + '></td><td><input type=\"checkbox\" id=\"RECORD_FROM\" class=\"route\" name=\"'\n    + key + '\"' + recordFrom + '></td><td><input type=\"checkbox\" id=\"PLAYBACK_TO\" class=\"route\" name=\"' + key + '\"' + playbackTo + '></td><td><input type=\"checkbox\" id=\"TIMELAPSE_TO\" class=\"route\" name=\"'\n    + key + '\"' + timelapseTo + '></td><td><input type=\"checkbox\" id=\"DRUM_TO\" class=\"route\" name=\"' + key + '\"' + drumTo + '></td><td><input type=\"checkbox\" id=\"SILENCE_TO\" class=\"route\" name=\"'\n    + key + '\"' + silenceTo + '></td><td><input type=\"checkbox\" id=\"SECBEFORE_TO\" class=\"route\" name=\"' + key + '\"' + secbeforeTo + '></td><td><label class=\"sampleRateLabel\" id=\"CHATRATELabel\" name=\"' + key + '\"></td>';\n  }\n  tableHTML = tableHTML + '</tr></table>';\n\n// latencyTable\n  let rangeHTML = '<table border=\"1\" id=\"latencyList\">';\n  for(let id in clients){\n    rangeHTML = rangeHTML = rangeHTML + '<tr id=\"latency_' + id + '\"><td rowspan=\"2\">' + clients[id][\"No\"] + '</td><td id=\"LATENCYLabel\">latency</td>';\n    for(let streamType in clients[id][\"STREAMS\"]){\n      if(streamType != \"SECBEFORE\" && streamType != \"RECORD\") rangeHTML = rangeHTML + '<td>' + streamType + '<input type=\"range\" class=\"range\" id=\"LATENCY_' + streamType + '\" name=\"' + id + '\" min=\"0\" max=\"10\" step=\"0.5\" value=\"' + clients[id][\"STREAMS\"][streamType][\"LATENCY\"] + '\" /></td>';\n    }\n    rangeHTML = rangeHTML + '</tr><tr id=\"rate_' + id + '\"><td id=\"RATELabel\"> sampleRate </td>';\n    for(let streamType in clients[id][\"STREAMS\"]){\n      if(streamType != \"RECORD\" && streamType != \"SECBEFORE\") rangeHTML = rangeHTML + '<td>' + streamType + '<input type=\"range\" class=\"range\" id=\"RATE_' + streamType + '\" name=\"' + id + '\" min=\"11025\" max=\"88200\" step=\"11025\" value=\"' + clients[id][\"STREAMS\"][streamType][\"RATE\"] + '\" /></td>';\n    }\n    rangeHTML = rangeHTML + '</tr>';\n  }\n  rangeHTML = rangeHTML + '</table>';\n\n\n// rangeTable\n  //let rangeTable = '<table border=\"1\" id=\"clientRangeList\"><tr id=\"tr\"><th>client</th> <th>id</th> <th>CHAT_RATE</th> <th>masterGain</th> <th>chatGain</th> <th>playbackGain</th> <th>timelapseGain</th> <th>drumGain</th> <th>oscGain</th> <th>noiseGain</th> <th>bassGain</th>';\n\n// sampleRate list\n  let sampleRateHTML = '<div id=\"sampleRate\"> Sample Rate <ul id=\"sampleRateList\">';\n  for(let key in statusList[\"sampleRate\"]){\n    sampleRateHTML = sampleRateHTML + '<li>' + key + ': <label class=\"sampleRate\" id=\"sampleRate' + key + 'Label\">' + String(statusList[\"sampleRate\"][key]) + '</label><input type=\"range\" class=\"range\" name=\"sampleRate\" id=\"' + key + '\" min=\"11025\" max=\"88200\" step=\"11025\" value=\"' + statusList[\"sampleRate\"][key] + '\" /></li>'\n  }\n  sampleRateHTML = sampleRateHTML + '</ul></div>';\n \n// gain list\n  let gainHTML = '<div id=\"gainCtrl\"> gain; <ul id=\"gainList\">';\n  for(let key in statusList[\"gain\"]) {\n    gainHTML = gainHTML + '<li>' + key.substr(0,key.length-4).toUpperCase() + ': <input type=\"range\" name=\"gain\" class=\"range\" id=\"' + key + '\" min=\"0\" max=\"1\" value=\"' + String(statusList[\"gain\"][key]) + '\" step=\"0.05\" /> <label id=\"gain' + key + 'Label\" class=\"gainLabel\">' + String(statusList[\"gain\"][key]) + '</label></li>';\n  }\n  gainHTML = gainHTML + '</ul> </div>';\n\n  HTML = tableHTML + rangeHTML + sampleRateHTML + gainHTML;\n  return HTML;\n}\n\nexports.statusPrint = function statusPrint(oscGainValue, freqVal, feedbackGainValue, noiseGainValue, bassFlag){\n  let statusText = \"\";\n  if(oscGainValue > 0){\n    statusText = String(freqVal) + \"Hz\";\n  }\n  if(feedbackGainValue > 0){\n    if(statusText === \"\"){\n      statusText = \"FEEDBACK\";\n    } else {\n      statusText = statusText + \", FEEDBACK\"\n    }\n  }\n  if(noiseGainValue > 0){\n    if(statusText === \"\"){\n      statusText = \"WHITENOISE\";\n    } else {\n      statusText = statusText + \", WHITENOISE\"\n    }\n  }\n  if(bassFlag){\n    if(statusText === \"\"){\n      statusText = \"BASS\";\n    } else {\n      statusText = statusText + \", BASS\"\n    }\n  }\n  return statusText;\n}\n\nexports.keycodeMap = function keycodeMap(keycode){\n  const keyMap = {\n// const keycodeMap = {\n  '48' : '0',\n  '49' : '1',\n  '50' : '2',\n  '51' : '3',\n  '52' : '4',\n  '53' : '5',\n  '54' : '6',\n  '55' : '7',\n  '56' : '8',\n  '57' : '9',\n  '65' : 'A',\n  '66' : 'B',\n  '67' : 'C',\n  '68' : 'D',\n  '69' : 'E',\n  '70' : 'F',\n  '71' : 'G',\n  '72' : 'H',\n  '73' : 'I',\n  '74' : 'J',\n  '75' : 'K',\n  '76' : 'L',\n  '77' : 'M',\n  '78' : 'N',\n  '79' : 'O',\n  '80' : 'P',\n  '81' : 'Q',\n  '82' : 'R',\n  '83' : 'S',\n  '84' : 'T',\n  '85' : 'U',\n  '86' : 'V',\n  '87' : 'W',\n  '88' : 'X',\n  '89' : 'Y',\n  '90' : 'Z',\n  '8'  : 'backspace',\n  '13' : 'enter',\n  '16' : 'shift',\n  '17' : 'ctrl',\n  '36' : 'home',\n  '18' : 'alt',\n  '9' : 'tab',\n  '32' : ' ',\n  '107' : 'add',\n  '20' : 'caps_lock',\n  '27' : 'escape',\n  '37' : 'left_arrow',\n  '38' : 'up_arrow',\n  '39' : 'right_arrow',\n  '40' : 'down_arrow',\n  '112' : 'f1' ,\n  '113' : 'f2' ,\n  '114' : 'f3' ,\n  '115' : 'f4' ,\n  '116' : 'f5' ,\n  '117' : 'f6' ,\n  '118' : 'f7' ,\n  '119' : 'f8' ,\n  '120' : 'f9' ,\n  '121' : 'f10',\n  '122' : 'f11',\n  '123' : 'f12',\n  '188' : 'comma',\n  \"190\" : \".\",\n  \"189\" : \"_\",\n  \"226\" : \"_\",\n  \"220\" : \"_\"\n  };\n  return keyMap[keycode];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/module.js","const modules = require('./module.js');\n\nnavigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;\nwindow.URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\nwindow.AudioContext = window.AudioContext || window.webkitAudioContext || window.mozAudioContext || window.msAudioContext;\n\nlet audioContext = new AudioContext();\nlet masterGain = audioContext.createGain();\n\nlet gainVal = {\n  \"master\": 0.7,\n  \"FEEDBACK\": 1,\n  \"OSC\": 1,\n  \"BASS\": 0.7,\n  \"CLICK\": 0.7,\n  \"NOISE\": 0.3,\n  \"CHAT\": 1,\n  \"PLAYBACK\": 0.7,\n  \"TIMELAPSE\": 0.7,\n  \"DRUM\": 0.7,\n  \"SECBEFORE\": 0.7,\n  \"SILENCE\": 0\n}\n\n//masterGain.gain.value = gainVal[\"master\"];\nmasterGain.gain.setTargetAtTime(gainVal.master,0,0);\nlet prevGain = 0.7;\nmasterGain.connect(audioContext.destination);\n\n// feedback\nlet feedbackGain = audioContext.createGain();\nfeedbackGain.gain.setTargetAtTime(0,0,0);\n//feedbackGain.gain.value = 0;\nlet filter = audioContext.createBiquadFilter();\nfilter.type = \"highpass\";\nfilter.frequency.setTargetAtTime(200,0,0);\n//record/play\nlet javascriptnode = audioContext.createScriptProcessor(8192, 1, 1);\nlet streamBuffer = [];\nlet lookBackBuffer = [];\nlet bufferSize = 8192;\nlet bufferRate = 44100;\n// sinewave\nlet osc = audioContext.createOscillator();\nlet oscGain = audioContext.createGain();\nlet oscPortament = 0;\nosc.connect(oscGain);\n//oscGain.connect(audioContext.destination);\noscGain.connect(masterGain);\nosc.frequency.setTargetAtTime(440,0,0);\n//osc.frequency.value = 440;\n//oscGain.gain.value = 0;\noscGain.gain.setTargetAtTime(0,0,0);\nosc.start(0);\nlet bassOsc = audioContext.createOscillator();\nlet bassGain = audioContext.createGain();\nbassOsc.connect(bassGain);\nbassGain.connect(masterGain);\nbassOsc.frequency.setTargetAtTime(20,0,0);\n//bassGain.gain.value = 0;\nbassGain.gain.setTargetAtTime(0,0,0);\nbassOsc.start(0);\n\n\nlet clickOsc = audioContext.createOscillator();\nlet clickGain = audioContext.createGain();\nclickOsc.connect(clickGain);\nclickGain.connect(masterGain);\nclickOsc.frequency.setTargetAtTime(440,0,0)\nclickGain.gain.setTargetAtTime(0,0,0);\nclickOsc.start(0);\n\n//whitenoise\nlet whitenoise = audioContext.createOscillator();\nlet whitenoiseNode = audioContext.createScriptProcessor(1024);\nlet noiseGain = audioContext.createGain();\nnoiseGain.gain.setTargetAtTime(0,0,0);\nwhitenoiseNode.onaudioprocess = (ev) => {\n  let buf0 = ev.outputBuffer.getChannelData(0);\n  let buf1 = ev.outputBuffer.getChannelData(1);\n  for(let i=0;i<1024;++i) {\n    buf0[i] = buf1[i] = (Math.random()-0.5);\n  }\n}\nwhitenoise.connect(whitenoiseNode);\nwhitenoiseNode.connect(noiseGain);\nnoiseGain.connect(masterGain);\n//whitenoiseNode.connect(audioContext.destination);\nwhitenoise.start(0);\n\n//munou no unmei\n/*\nlet munouOsc = audioContext.createOscillator();\nlet munouGain = audioContext.createGain();\nmunouOsc.connect(munouGain);\n//oscGain.connect(audioContext.destination);\nmunouGain.connect(masterGain);\nmunouOsc.frequency.value = 110;\nmunouGain.gain.value = 0;\nmunouOsc.start(0);\n*/\n// chat\nlet chatBuffer = {};\nlet chatGain = audioContext.createGain();\nchatGain.gain.setTargetAtTime(1,0,0);\nchatGain.connect(masterGain);\n\nlet convolver = audioContext.createConvolver();\n//convolver.context.sampleRate = 44100;\nlet revGain = audioContext.createGain();\nrevGain.gain.setTargetAtTime(3,0,0);\nconsole.log(convolver.context.sampleRate);\nconvolver.connect(revGain);\nrevGain.connect(masterGain);\nconvolver.connect(masterGain);\n//let droneBuff = [];\nlet droneBuff = {}\n/*let streamGain = {\n\"CHAT\": 1,\n\"PLAYBACK\": 0.7,\n\"TIMELAPSE\": 0.7,\n\"DRUM\": 0.7,\n\"SECBEFORE\": 0.7,\n\"SILENCE\": 0\n};*/\nlet timelapseFlag = false;\n\n// voice\nconst ssu = new SpeechSynthesisUtterance();\nssu.lang = 'en-EN';\nlet voice =false;\n\nconst modList= [0.5, 0.5, 1, 18];\nconst chordList = [1, 4/3, 9/4, 15/8, 17/8, 7/3, 11/3];\nlet chordChange = 0;\nlet modChange = 0;\nlet freqVal;\n\n// alert sound\nlet alertBuffer = null;\n\nconst alertPlay = () => {\n  let src = audioContext.createBufferSource();\n  src.buffer = alertBuffer;\n  src.connect(audioContext.destination);\n  src.start();\n  // console.log(\"alert\");\n}\nconst click = (frequency) => {\n  if(frequency){\n    clickOsc.frequency.setTargetAtTime(frequency,0,0)\n  } else {\n    clickOsc.frequency.setTargetAtTime(440,0,0)\n  }\n  //clickOsc.frequency.value = frequency || 440\n  modules.textPrint(ctx, canvas, \"CLICK\")\n  let t0 = audioContext.currentTime;\n//  clickGain.gain.value = 0.7;\n  clickGain.gain.setValueAtTime(gainVal[\"CLICK\"], t0);\n  clickGain.gain.setTargetAtTime(0,t0,0.03);\n  setTimeout(()=>{\n    modules.whitePrint(ctx, canvas);\n    // modules.textPrint(ctx, canvas, \"\");\n  },300);\n}\n\nconst loadSample = (ctx, url) => {\n  let req = new XMLHttpRequest();\n  req.open(\"GET\", url, true);\n  req.responseType = \"arraybuffer\";\n  req.onload = () => {\n    if(req.response) {\n      ctx.decodeAudioData(req.response).then(function(b){alertBuffer=b;},function(){});\n    }\n  }\n  req.send();\n}\nloadSample(audioContext, \"/files/alert.wav\");\n\nconst bassLine = [55,68.75,68.75,82.5,82.5,103.125,110];\nlet bassFlag = false;\n\nconst bass = ()  => {\n  if(bassFlag){\n    //bassGain.gain.value = 0;\n    bassGain.gain.setTargetAtTime(0,0,0.02);\n    bassFlag = false;\n    modules.whitePrint(ctx, canvas);\n  } else {\n    modules.whitePrint(ctx, canvas);\n    // console.log(\"vass\");\n    modules.textPrint(ctx, canvas, \"BASS\");\n    bassOsc.frequency.setTargetAtTime(bassLine[Math.floor(bassLine.length * Math.random())],0,0)\n    //bassGain.gain.value = gainVal[\"BASS\"];\n    bassGain.gain.setTargetAtTime(gainVal.BASS,0,0.02);\n    bassFlag = true;\n0.02}\n}\n\nconst filterChange = () => {\n  let returnValue = 0;\n  switch(filter.frequency.value){\n    case 200:\n      returnValue = 2000;\n      break;\n    case 2000:\n      returnValue = 8000;\n      break;\n    case 8000:\n      returnValue = 14000;\n      break;\n    case 14000:\n      returnValue = 0;\n      break;\n    default:\n      returnValue = 200;\n      break;\n  }\n  filter.frequency.setTargetAtTime(returnValue,0,0)\n  return returnValue;\n}\n\n//video record/play \nlet image;\nlet receive;\nlet receive_ctx;\nconst onAudioProcess = (e) => {\n  if(videoMode.mode != \"none\"){\n    console.log(videoMode);\n    let bufferData = new Float32Array(bufferSize);\n    e.inputBuffer.copyFromChannel(bufferData, 0);\n    if(videoMode.mode === \"record\"){\n      modules.chunkEmit({\"audio\":bufferData, \"video\":funcToBase64(buffer, video), \"target\": \"PLAYBACK\"},socket);\n    } else if(videoMode.option != \"drone\"){\n      switch(videoMode.mode){\n        /*case \"record\":\n        //modules.chunkEmit({\"audio\":bufferData, \"video\":funcToBase64(buffer, video), \"target\": \"PLAYBACK\"},socket);\n        //break;*/\n        case \"chat\":\n          console.log(\"CHAT\");\n          chatBuffer[\"audio\"] = bufferData;\n          chatBuffer[\"video\"] = funcToBase64(buffer, video);\n          chatBuffer[\"target\"] = \"CHAT\";\n          break;\n        case \"pastBuff\":\n          streamBuffer.push({\n            \"audio\": bufferData,\n            \"video\": funcToBase64(buffer, video)\n          });\n          break;\n        case \"pastPlay\":\n          let beforeChunk = {};\n          if(streamBuffer.length>0){\n            beforeChunk = streamBuffer.shift();\n          } else {\n            beforeChunk = {\"audio\": bufferData, \"video\": funcToBase64(buffer, video)};\n          }\n            playAudioStream(beforeChunk[\"audio\"],bufferRate,gainVal[\"SECBEFORE\"],false);\n            playVideo(beforeChunk[\"video\"]);\n             console.log(streamBuffer.length);\n            streamBuffer.push({\n              \"audio\": bufferData,\n              \"video\": funcToBase64(buffer, video)\n            })\n          break;\n        /*\n        case \"droneChat\":\n          chatBuffer[\"audio\"] = bufferData;\n          chatBuffer[\"video\"] = modules.toBase64(buffer, video);\n          chatBuffer[\"target\"] = \"DRONECHAT\";\n          //console.log(droneBuff);\n          //if(droneBuff != undefined || droneBuff != {}){\n          if(\"audio\" in droneBuff){\n            //console.log(droneBuff.sampleRate);\n            //console.log(droneBuff.gain);\n            playAudioStream(droneBuff[\"audio\"],droneBuff[\"sampleRate\"],droneBuff[\"gain\"],false);\n            playVideo(droneBuff[\"video\"]);\n          } else {\n            //console.log(\"debug\");\n            modules.textPrint(ctx, canvas, stringsClient);\n            //ssu?\n          }\n          break;\n          */\n      }\n    } else { //DRONE\n      if(droneBuff != undefined && droneBuff != {} && droneflag){\n       // if(\"audio\" in playBuff) {\n        //if(\"audio\" in playBuff && !bufferPlaying) {\n        if(\"audio\" in droneBuff) {\n        //if(\"audio\" in droneBuff && !bufferPlaying) {\n          //playAudioStream(playBuff[\"audio\"],44100,1,false);\n          playAudioStream(droneBuff[\"audio\"],droneBuff[\"sampleRate\"],1,false);\n        }\n        //if(\"video\" in playBuff){\n        if(\"video\" in droneBuff){\n          playVideo(droneBuff[\"video\"]);\n        } else {\n          modules.textPrint(ctx, canvas, stringsClient);\n        }\n        //console.log(\"play\");\n        //if(droneBuff.target === \"CHAT\"){\n          chatBuffer[\"audio\"] = bufferData;\n          chatBuffer[\"video\"] = modules.toBase64(buffer, video);\n          chatBuffer[\"target\"] = droneBuff.target;\n        //} else {\n         // socket.emit('wavReqFromClient', data[\"target\"]);\n       // }\n      }\n    }\n  }\n  if(timelapseFlag){\n    let bufferData = new Float32Array(bufferSize);\n    e.inputBuffer.copyFromChannel(bufferData, 0);\n    let sendChunk = {\"audio\":bufferData, \"video\": funcToBase64(buffer, video), \"target\": \"TIMELAPSE\"};\n    modules.chunkEmit(sendChunk,socket);\n    timelapseFlag = false;\n  }\n}\nconst playAudioStream = (flo32arr, sampleRate, volume, glitch) => {\n  //if(!glitch){\n    let audio_src = audioContext.createBufferSource();\n    let audioData = new Float32Array(bufferSize);\n    for(let i = 0; i < audioData.length; i++){\n      audioData[i] = flo32arr[i] * volume;\n    }\n    if(!glitch){\n      //console.log(sampleRate)\n      let audio_buf = audioContext.createBuffer(1, bufferSize, sampleRate)\n      audio_buf.copyToChannel(audioData, 0);\n      audio_src.buffer = audio_buf;\n      audio_src.connect(masterGain);\n    } else { //GLITCH\n      let audio_buf = audioContext.createBuffer(1, bufferSize, convolver.context.sampleRate)\n      audio_buf.copyToChannel(audioData, 0);\n      // console.log(audio_buf);\n\n      audio_src.buffer = audio_buf;\n      convolver.buffer = audio_buf;\n      audio_src.connect(convolver);\n    }\n    //let timeOut = audio_src.buffer.duration * 1000;\n    bufferPlaying = true\n    audio_src.onended = ()=>{\n      bufferPlaying = false\n    }\n    audio_src.start(0);\n    /*\n    droneflag = false\n    setTimeout(()=>{\n      droneflag = true\n    },timeOut);*/\n  //}\n}\nlet bufferPlaying = false\ndroneflag = true;\n//video record/play \n\nconst initialize = () =>{\n  if(navigator.mediaDevices.getUserMedia){\n    navigator.mediaDevices.getUserMedia({\n      video: true, audio: /*true*/{\n        \"mandatory\": {\n          \"googEchoCancellation\": false,\n          \"googAutoGainControl\": false,\n          \"googNoiseSuppression\": false,\n          \"googHighpassFilter\": false\n        },\"optional\": []\n      } \n    }).then((stream) =>{\n    //}, (stream) =>{\n      let mediastreamsource = void 0;\n      mediastreamsource = audioContext.createMediaStreamSource(stream);\n      mediastreamsource.connect(filter);\n      filter.connect(javascriptnode);\n      filter.connect(feedbackGain);\n      //      selfGain.connect(analyser);\n  //    feedbackGain.connect(audioContext.destination);\n      feedbackGain.connect(masterGain);\n      //video\n      video = document.getElementById('video');\n      video.src = window.URL.createObjectURL(stream);\n      video.play();\n      video.volume = 0;\n      renderStart();\n    },  (e) =>{\n      return console.log(e);\n    });\n  } else {\n    navigator.getUserMedia({\n      video: true, audio: {\n        \"mandatory\": {\n          \"googEchoCancellation\": false,\n          \"googAutoGainControl\": false,\n          \"googNoiseSuppression\": false,\n          \"googHighpassFilter\": false\n        },\"optional\": []\n      } \n    }, (stream) =>{\n    //}, (stream) =>{\n      let mediastreamsource = void 0;\n      mediastreamsource = audioContext.createMediaStreamSource(stream);\n      mediastreamsource.connect(filter);\n      filter.connect(javascriptnode);\n      filter.connect(feedbackGain);\n      //      selfGain.connect(analyser);\n  //    feedbackGain.connect(audioContext.destination);\n      feedbackGain.connect(masterGain);\n      //video\n      video = document.getElementById('video');\n      video.src = window.URL.createObjectURL(stream);\n      video.play();\n      video.volume = 0;\n      renderStart();\n    },  (e) =>{\n      return console.log(e);\n    });\n  }\n  //rec\n  javascriptnode.onaudioprocess = onAudioProcess;\n  // javascriptnode.connect(audioContext.destination);\n  javascriptnode.connect(masterGain);\n  //video\n  image = document.createElement(\"img\");\n  receive = document.getElementById(\"cnvs\");\n  receive_ctx = receive.getContext(\"2d\");\n};\n\n//metronome\nlet rhythmProperty = {\n  \"bpm\": 60,\n  \"interval\": 1000,\n  \"score\": [1,1,1,1],\n  \"timbre\": 440\n};\nlet metronome;\nlet metronomeCount = 0;\nconst startRhythm = (interval) =>{\n  metronome = setInterval(()=>{\n    if(rhythmProperty.score[metronomeCount] === 1){\n      switch(rhythmProperty.timbre){\n        default:\n          click(rhythmProperty.timbre)\n          /*\n          clickOsc.frequency.value = rhythmProperty.timbre\n          clickGain.gain.setValueAtTime(gainVal[\"CLICK\"], t0);\n          clickGain.gain.setTargetAtTime(0,t0,0.03);\n          */\n      }\n    }\n    if(metronomeCount+1 < rhythmProperty.score.length){\n      metronomeCount++\n    } else {\n      metronomeCount = 0\n    }\n  },interval); \n}\n\nconst stopRhythm = () => {\n  clearInterval(metronome);\n}\n\n//keyboard\nlet stringsClient = \"\";\n\n\n$(() =>{\n  $(document).on(\"keydown\", (e)=> {\n    console.log(e.keyCode);\n    if(e.keyCode === 188){\n      if(standAlone) {\n        standAlone = false;\n        modules.whitePrint(ctx, canvas);\n        modules.textPrint(ctx, canvas, \"network connect\");\n        setTimeout(()=>{\n          modules.whitePrint(ctx, canvas);\n//          modules.textPrint(ctx, canvas, \"\");\n        },300);\n      } else {\n        standAlone = true;\n        modules.whitePrint(ctx, canvas);\n        modules.textPrint(ctx, canvas, \"stand alone\");\n        setTimeout(()=>{\n          modules.whitePrint(ctx, canvas);\n//          modules.textPrint(ctx, canvas, \"\");\n        },300);\n      }\n      socket.emit('standAlonefromClient', standAlone);\n    } else if(standAlone){\n      // let charCode = keycodeMap[String(e.keyCode)];\n      let charCode = modules.keycodeMap(String(e.keyCode));\n      if(charCode === \"enter\"){\n        // console.log(isNaN(Number(stringsClient)));\n        if (isNaN(Number(stringsClient)) === false && stringsClient != \"\") {\n          doCmd({\n            \"cmd\":\"SINEWAVE\",\n            \"property\": Number(stringsClient)\n          });\n//          console.log(\"sinewave stand alone\")\n        } else {\n          doCmd({\"cmd\":stringsClient});\n        }\n        stringsClient = \"\";\n      } else if(charCode === \"escape\") {\n        doCmd({\"cmd\":\"STOP\"});\n        stringsClient = \"\";\n      } else if(charCode === \"left_arrow\" || charCode === \"backspace\"){\n        stringsClient = \"\";\n        modules.whitePrint(ctx, canvas);\n      } else if(e.keyCode >= 48 && e.keyCode <= 90 || e.keyCode === 190 || e.keyCode === 189 || e.keyCode === 32 || e.keyCode === 16){\n        switch(charCode){\n          case \"C\":\n            click();\n            break;\n          case \"B\":\n            bass();\n            break;\n          case \"F\":\n            doCmd({\"cmd\":\"FEEDBACK\"});\n            break;\n          case \"W\":\n          case \"N\":\n            doCmd({\"cmd\":\"WHITENOISE\"})\n            break;\n          case \"S\":\n            doCmd({\"cmd\":\"SAMPLERATE\"});\n            break;\n          default:\n            stringsClient = stringsClient + charCode;\n            modules.whitePrint(ctx, canvas);\n            modules.textPrint(ctx, canvas, stringsClient);\n            break;\n        }\n      }\n    } else {\n      // let charCode = keycodeMap[String(e.keyCode)];\n      let charCode = modules.keycodeMap(String(e.keyCode));\n      stringsClient = modules.keyDownFunc(e.keyCode, stringsClient, socket);\n      modules.whitePrint(ctx, canvas);\n      modules.textPrint(ctx, canvas, stringsClient);\n      if(e.keyCode === 17 || e.keyCode === 0){\n        bass();\n        strings = \"\";\n        stringsClient = \"\";\n      }\n      // if(e.keyCode != 16){\n        if(e.keyCode === 13 && stringsClient === \"VOICE\"){\n          if(voice){\n            voice = false;\n            modules.whitePrint(ctx, canvas);\n            modules.textPrint(ctx, canvas, \"VOICE OFF\");\n            stringsClient = \"\";\n            setTimeout(()=>{\n              modules.whitePrint(ctx, canvas);\n              modules.charEmit(37, socket);\n            },500);\n          } else {\n            voice = true;\n            modules.whitePrint(ctx, canvas);\n            modules.textPrint(ctx, canvas, \"VOICE MODE\");\n            stringsClient = \"\";\n            setTimeout(()=>{\n              modules.charEmit(37, socket);\n            },500);\n          }\n//          stringsClient = \"\";\n        }\n      if(charCode === \"enter\" && voice && stringsClient === \"STOP\") speakVoice(stringsClient)\n      if(charCode === \"enter\") stringsClient = \"\"\n      // }\n      // if(charCode = \"enter\" && voice && stringsClient != \"VOICE\") {\n        /*\n      if(charCode === \"enter\" && voice && stringsClient != \"VOICE\"){\n        ssu.text = stringsClient;\n        speechSynthesis.speak(ssu);\n        stringsClient = \"\";\n      }*/\n    }\n  });\n});\n\n\nwindow.addEventListener(\"load\", initialize, false);\n\n\n\n// \n// canvas\n\nlet canvas = document.getElementById('cnvs');\nlet ctx = canvas.getContext('2d');\nlet buffer;\nlet bufferContext;\n\n$(() => {\n  sizing();\n//  draw();\n  $(window).resize(() =>{\n    sizing();\n  });\n});\nconst sizing=() =>{\n  $(\"#cnvs\").attr({ height: $(window).height() });\n  $(\"#cnvs\").attr({ width: $(window).width() });\n}\n\n\n\nconst renderStart=()=> {\n  video = document.getElementById('video');\n  buffer = document.createElement('canvas');\n  bufferContext = buffer.getContext('2d');\n\n  let render = () => {\n    requestAnimationFrame(render);\n    let width = video.videoWidth;\n    let height = video.videoHeight;\n    if(width == 0 || height ==0) {return;}\n    buffer.width = width;\n    buffer.height = height;\n    bufferContext.drawImage(video, 0, 0);\n  }\n  render();\n}\n\n/* socket */\nsocket.emit('connectFromClient', client);\nsocket.on('connectFromServer', (data) => {\n  rhythmProperty = data.rhythm\n})\n\nsocket.on('stringsFromServer', (data) =>{\n  modules.whitePrint(ctx, canvas);\n  modules.textPrint(ctx, canvas, data);\n  //speakVoice(data)\n});\n\nsocket.on('statusViewFromServer', ()=>{\n  let statusText = modules.statusPrint(oscGain.gain.value, freqVal, feedbackGain.gain.value, noiseGain.gain.value, bassFlag);\n  strings = \"\";\n  stringsClient = \"\";\n  modules.whitePrint(ctx, canvas);\n  modules.textPrint(ctx, canvas, statusText);\n  setTimeout(()=>{\n    modules.whitePrint(ctx, canvas);\n  },500)\n});\n\nsocket.on('cmdFromServer', (data) => {\n  if(standAlone === false){\n    doCmd(data);\n  }\n});\nsocket.on('textFromServer', (data) => {\n  speakVoice(data)\n  modules.whitePrint(ctx, canvas);\n  modules.textPrint(ctx, canvas, data);\n  setTimeout(()=>{\n    modules.whitePrint(ctx, canvas);\n  },800)\n  stringsClient = \"\";\n});\n\nsocket.on('instructionFromServer', (data) => {\n  videoStop();\n  modules.whitePrint(ctx, canvas);\n  modules.textPrint(ctx, canvas, data[\"text\"]);\n  //alertPlay();\n  speakVoice(data)\n  mode = \"instruction\"\n  setTimeout(()=>{\n    modules.whitePrint(ctx, canvas);\n    mode = \"none\"\n  }, data[\"duration\"]);\n});\n\nsocket.on('streamListFromServer', (data) =>{\n  streamList = data;\n  console.log(streamList);\n});\n\nsocket.on('streamReqFromServer', (data) => {\n  switch(data){\n    case \"CHAT\":\n    case \"droneChat\":\n      //if(chatBuffer!= {}){\n        socket.emit('chunkFromClient', chatBuffer);\n      /*} else {\n        socket.emit('chunkFromClient', {\n          \"audio\" : \"\",\n          \"video\" : \"\",\n          \"target\": \"CHAT\"\n        });\n      }*/\n    break;\n  }\n});\n\nsocket.on('oscFromServer',(data) => {\n  let uint8arr = osc.toBuffer(data);\n});\n/*\nconst playGlitchedURL = (url) => {\n  if(~url.indexOf(\"data:image/jpeg;base64,\")){\n    let audioURL = \"data:audio/wav;base64,\" + url.split(\"data:image/jpeg;base64,\")[1].slice(0,-2) + \"gAA==\";\n    console.log(audioURL);\n    let buff = Base64Binary.decodeArrayBuffer(audioURL);\n    audioContext.decodeAudioData(buff, (audioData)=>{\n      let audioSrc = audioContext.createBufferSource()\n      audioSrc.buffer = audioData\n      audioSrc.connect(masterGain);\n      audioSrc.start(0);\n    });\n  //  decodeaudiodata\n  }\n}\n*/\nsocket.on('chunkFromServer', (data) => {\n  //if(videoMode.mode === \"chat\"){\n  if(videoMode.mode != \"record\"){\n    if(videoMode.mode != \"chat\" && data.target === \"CHAT\") videoMode.mode = \"chat\";\n    //if(data.target === \"DRONECHAT\" && videoMode.mode === \"droneChat\"){\n    if(videoMode.option === \"drone\"){\n      //droneBuff.push(data)\n      droneBuff = data\n      //socket.emit('wavReqFromClient', data[\"target\"]);\n      //console.log(\"wavReq\");\n      //socket.emit('chunkFromClient', chatBuffer);\n    //  socket.emit('AckFromClient', \"CHAT\");\n    } else {\n      if(data[\"audio\"] != undefined && data[\"audio\"] != \"\") {\n\n        let chunkGain = 0.7;\n        if(data[\"target\"] in gainVal){\n          chunkGain = gainVal[data[\"target\"]];\n        }\n        //let playsampleRate = 44100\n        //if(data.sampleRate != undefined) {\n          let playsampleRate = Number(data.sampleRate)\n        //}\n        //console.log(playsampleRate);\n        //playAudioStream(data[\"audio\"],Number(data[\"sampleRate\"]),chunkGain,data[\"glitch\"]);\n        playAudioStream(data[\"audio\"],playsampleRate,chunkGain,data[\"glitch\"]);\n        //if(data.glitch) playGlitchedURL(data.video);\n      }\n      if(data[\"video\"] != undefined && data[\"video\"] != \"\") {\n         playVideo(data[\"video\"]);\n      } else if(data.target != \"CHAT\"){\n        modules.whitePrint(ctx, canvas);\n        modules.textPrint(ctx, canvas, data[\"target\"]);\n      } else {\n        modules.whitePrint(ctx, canvas);\n      }\n    }\n    if(data[\"target\"] === \"CHAT\"){\n      socket.emit('AckFromClient', \"CHAT\");\n    } else {\n      socket.emit('wavReqFromClient', data[\"target\"]);\n    }\n  }\n});\nconst speakVoice = (data) =>{\n  if(voice && data != \"VOICE\"){\n    ssu.text = data;\n    speechSynthesis.speak(ssu);\n  }\n}\n\nconst doCmd = (cmd) => {\n  // console.log(\"do cmd\" + cmd[\"cmd\"]);\n  let t0 = audioContext.currentTime;\n  switch(cmd[\"cmd\"]){\n    case \"WHITENOISE\":\n    case \"NOISE\":\n//      stop();\n      if(noiseGain.gain.value > 0){\n        mode = \"none\";\n        //noiseGain.gain.value = 0;\n        noiseGain.gain.setTargetAtTime(0,0,0.01);\n        modules.textPrint(ctx, canvas, \"\");\n      } else {\n        mode = \"whitenoise\";\n        //noiseGain.gain.value = gainVal[\"NOISE\"];\n        noiseGain.gain.setTargetAtTime(gainVal.NOISE,0,0.01);\n        modules.whitePrint(ctx, canvas);\n        modules.textPrint(ctx, canvas, \"WHITENOISE\");\n      }\n      speakVoice(\"NOISE\")\n      break;\n    case \"CLICK\":\n      click();\n      speakVoice(cmd.cmd)\n      break;\n    case \"BASS\":\n      bass();\n      //speakVoice(cmd.cmd)\n      break;\n    case \"SINEWAVE\":\n      modules.whitePrint(ctx, canvas);\n      if(oscGain.gain.value > 0 && freqVal === cmd[\"property\"]) {\n        mode = \"none\";\n        //oscGain.gain.value = 0;\n        oscGain.gain.setTargetAtTime(0,0,0.01);\n//        modules.textPrint(ctx, canvas, \"\");\n      } else {\n        mode = \"sinewave\";\n        chordChange = 0;\n        modules.textPrint(ctx, canvas, String(cmd[\"property\"]) + \"Hz\");\n        // console.log(t0);\n        freqVal = cmd[\"property\"];\n        if(oscPortament === 0){\n          osc.frequency.setTargetAtTime(freqVal,0,0)\n        } else {\n          osc.frequency.setTargetAtTime(freqVal,t0,oscPortament);\n        }\n        //osecGain.gain.value = gainVal[\"OSC\"];\n        oscGain.gain.setTargetAtTime(gainVal.OSC,0,0.01);\n      }\n      speakVoice(String(cmd[\"property\"]) + \" Hz\")\n      break;\n    case \"SINEWAVE_UP\":\n//      osc.frequency.value = osc.frequency.value + cmd[\"property\"];\n      freqVal = osc.frequency.value + cmd[\"property\"];\n      if(oscPortament === 0){\n        osc.frequency.setTargetAtTime(freqVal,0,0);\n      } else {\n        osc.frequency.setTargetAtTime(freqVal,t0,oscPortament);\n      }\n      modules.whitePrint(ctx, canvas);\n      mode = \"sinewave\";\n      chordChange = 0;\n      modules.textPrint(ctx, canvas, String(freqVal) + \"Hz\");\n     // oscGain.gain.value = gainVal[\"OSC\"];\n      oscGain.gain.setTargetAtTime(gainVal.OSC,0,0.01);\n      speakVoice(String(cmd.property)+ \"Hz UP\")\n      break;\n    case \"SINEWAVE_DOWN\":\n      modules.whitePrint(ctx, canvas);\n      freqVal = osc.frequency.value - cmd[\"property\"];\n      if(freqVal >= 0){\n        if(oscPortament === 0){\n          osc.frequency.setTargetAtTime(freqVal,0,0);\n        } else {\n          osc.frequency.setTargetAtTime(freqVal,t0,oscPortament);\n        }\n        mode = \"sinewave\";\n        chordChange = 0;\n        modules.textPrint(ctx, canvas, String(freqVal) + \"Hz\");\n        //oscGain.gain.value = gainVal[\"OSC\"];\n        oscGain.gain.setTargetAtTime(gainVal.OSC,0,0.01);\n      }\n      speakVoice(String(cmd.property)+ \"Hz DOWN\")\n      break;\n    case \"PORTAMENT\":\n      modules.whitePrint(ctx, canvas);\n      modules.textPrint(ctx, canvas, \"PORTAMENT: \" + String(cmd[\"property\"]) + \"SEC\");\n      oscPortament = cmd[\"property\"];\n      break;\n    case \"FEEDBACK\":\n    case \"FEED\":\n      if(feedbackGain.gain.value > 0) {\n        mode = \"none\";\n        //feedbackGain.gain.value = 0;\n        feedbackGain.gain.setTargetAtTime(0,0,0.01);\n        modules.whitePrint(ctx, canvas);\n      } else {\n        mode = \"feedback\"\n        // console.log(\"feedback\")\n        //feedbackGain.gain.value = gainVal[\"FEEDBACK\"];\n        feedbackGain.gain.setTargetAtTime(gainVal.FEEDBACK,0,0.01);\n        modules.whitePrint(ctx, canvas);\n        modules.textPrint(ctx, canvas, \"FEEDBACK\");\n      }\n      speakVoice(cmd.cmd)\n      break;\n    case \"FILTER\":\n      let printText = filterChange();\n      modules.whitePrint(ctx, canvas);\n      modules.textPrint(ctx, canvas, \"FILTER: \" + String(printText) + \"Hz\");\n      setTimeout(() => {\n        modules.whitePrint(ctx, canvas);\n//        modules.textPrint(ctx, canvas, \"\");\n      },800);\n      break;\n    case \"GAIN\":\n      //console.log(\"TEST\");\n      modules.textPrint(ctx, canvas, cmd[\"property\"][\"target\"] + \": \" + String(cmd[\"property\"][\"val\"]));\n      gainVal[cmd[\"property\"][\"target\"].substr(0,cmd[\"property\"][\"target\"].length - 4).toUpperCase()] = Number(cmd[\"property\"][\"val\"]);\n      if(eval(cmd[\"property\"][\"target\"]) != undefined){\n        if(cmd[\"property\"][\"target\"] != \"clickGain\" && (cmd[\"property\"][\"target\"] === \"masterGain\" || eval(cmd[\"property\"][\"target\"]).gain.value > 0)){\n          //eval(cmd[\"property\"][\"target\"]).gain.value = Number(cmd[\"property\"][\"val\"]);\n          eval(cmd[\"property\"][\"target\"].gain.setTargetAtTime(Number(cmd[\"property\"][\"val\"],0,0.01)));\n        }\n\n        console.log(eval(cmd[\"property\"][\"target\"]).gain);\n      // } else {\n        // streamGain[cmd[\"property\"][\"target\"].substr(0,cmd[\"property\"][\"target\"].length - 4).toUpperCase] = Number(cmd[\"property\"][\"val\"]);\n      }\n      // console.log(gainVal);\n      if(cmd[\"property\"][\"target\"] === masterGain){\n        masterGain.gain.setTargetAtTime(Number(cmd[\"property\"][\"val\"]),0,0.01)\n      }\n      setTimeout(()=>{\n        modules.whitePrint(ctx, canvas);\n      }, 500)\n      break;\n    case \"VOLUME\":\n      if(cmd[\"property\"] === \"UP\"){\n        modules.whitePrint(ctx, canvas);\n        if(masterGain.gain.value === 1){\n          modules.textPrint(ctx, canvas, \"VOLUME IS FULL\");\n          setTimeout(()=>{\n            modules.whitePrint(ctx, canvas);\n          }, 500);\n        } else {\n          masterGain.gain.setTargetAtTime(masterGain.gain.value + 0.1,0,0.01)\n          modules.textPrint(ctx, canvas, \"VOLUME \" + cmd[\"property\"]);\n          setTimeout(()=>{\n            modules.whitePrint(ctx, canvas);\n          }, 500);\n        }\n      } else if(cmd[\"property\"] === \"DOWN\"){\n        modules.whitePrint(ctx, canvas);\n        if(masterGain.gain.value === 0){\n          modules.textPrint(ctx, canvas, \"MUTED\");\n          setTimeout(()=>{\n            modules.whitePrint(ctx, canvas);\n          }, 500);\n        } else {\n          //masterGain.gain.value = masterGain.gain.value - 0.1;\n          masterGain.gain.setTargetAtTime(masterGain.gain.value - 0.1,0,0.01)\n          modules.textPrint(ctx, canvas, \"VOLUME \" + cmd[\"property\"]);\n          setTimeout(()=>{\n            modules.whitePrint(ctx, canvas);\n          }, 500);\n        }\n      } else {\n        if(isNaN(Number(cmd[\"property\"])) === false && cmd[\"property\"] != \"\"){\n          masterGain.gain.setTargetAtTime(Number(cmd[\"property\"]),0,0.01)\n        }\n        modules.textPrint(ctx, canvas, \"VOLUME \" + cmd[\"property\"]);\n        setTimeout(()=>{\n          modules.whitePrint(ctx, canvas);\n        }, 500);\n      }\n      prevGain = masterGain.gain.value;\n      speakVoice(cmd.cmd + \" \" + String(cmd.property))\n      break;\n    case \"MUTE\":\n      //if(cmd[\"property\"]){\n      if(masterGain.gain.value > 0){\n        prevGain = masterGain.gain.value;\n        masterGain.gain.value.setTargetAtTime(0,0,0.01)\n        modules.whitePrint(ctx, canvas);\n        modules.textPrint(ctx, canvas, \"MUTE\");\n        setTimeout(()=>{modules.whitePrint(ctx, canvas);},500);\n      } else {\n        masterGain.gain.setTargetAtTime(prevGain,0,0.01)\n        modules.whitePrint(ctx, canvas);\n        modules.textPrint(ctx, canvas, \"UNMUTE\");\n        setTimeout(()=>{modules.whitePrint(ctx, canvas);},500);\n      }\n      speakVoice(cmd.cmd)\n      break;\n    case \"SWITCH ON\":\n    case \"SWITCH OFF\":\n      modules.whitePrint(ctx, canvas);\n      modules.textPrint(ctx, canvas, cmd[\"cmd\"]);\n      setTimeout(()=>{\n        modules.whitePrint(ctx, canvas);\n      }, 1500);\n      speakVoice(cmd.cmd)\n      break;\n    case \"RECORD\":\n    case \"REC\":\n      videoStop();\n      videoMode.mode = \"record\";\n      modules.whitePrint(ctx, canvas);\n      modules.textPrint(ctx, canvas, \"RECORD\");\n      setTimeout(() => {\n        if(videoMode.mode === \"record\"){\n          videoMode.mode = \"none\";\n          modules.whitePrint(ctx, canvas);\n        }\n      }, 5000); //\n      speakVoice(cmd.cmd)\n      break;\n    case \"SHUTTER\":\n      if(cmd[\"property\"] === \"oneshot\"){\n        timelapseFlag = true;\n      } else if(cmd[\"property\"] === \"timelapse\"){\n        timeLapse();\n      } else if(cmd[\"property\"] === \"stoplapse\"){\n        stopLapse();\n      }\n      //speakVoice(cmd.cmd)\n      break;\n    case \"SECBEFORE\":\n      streamBuffer = [];\n      modules.whitePrint(ctx, canvas);\n      modules.textPrint(ctx, canvas, String(cmd[\"property\"]) + \"SEC BEFORE\");\n      videoMode.mode = \"pastBuff\";\n      if(cmd[\"rate\"] != undefined){\n        bufferRate = cmd[\"rate\"];\n      } else {\n        bufferRate = 44100;\n      }\n      setTimeout(()=>{\n        modules.whitePrint(ctx, canvas);\n        videoMode.mode = \"pastPlay\";\n      },cmd[\"property\"] * 1000);\n      speakVoice(String(cmd.property) + \"SECOND BEFORE\")\n      break;\n    case \"DRONE\":\n      if(cmd.property){\n      //if(videoMode.option != \"drone\"){\n        videoMode.option = \"drone\"\n        modules.whitePrint(ctx, canvas);\n        modules.textPrint(ctx, canvas, cmd[\"cmd\"]);\n        setTimeout(()=>{\n          modules.whitePrint(ctx, canvas);\n        },500)\n        speakVoice(String(cmd.cmd))\n      } else {\n        videoMode.option = \"none\"\n        modules.whitePrint(ctx, canvas);\n        modules.textPrint(ctx, canvas, \"NOT DRONE\");\n        setTimeout(()=>{\n          modules.whitePrint(ctx, canvas);\n        },500)\n        speakVoice(\"NOT \" + String(cmd.cmd))\n      }\n      break;\n    case \"METRONOME\":\n      //console.log(cmd.property);\n      //if(cmd.type === \"param\") {\n      if(cmd.property === \"STOP\"){\n        stopRhythm();\n        speakVoice(cmd.cmd + \" STOP\")\n      } else {\n        modules.whitePrint(ctx, canvas);\n        modules.textPrint(ctx, canvas, \"BPM:\" + String(Math.floor(cmd.property.bpm * 10)/10))\n          rhythmProperty = cmd.property;\n          console.log(rhythmProperty);\n          if(cmd.trig){\n            stopRhythm();\n            setTimeout(()=>{\n              modules.whitePrint(ctx, canvas);\n              startRhythm(rhythmProperty.interval);\n            },rhythmProperty.interval)\n          }\n      //}\n      //if(cmd.trig) startRhythm();\n        speakVoice(cmd.cmd)\n      }\n      break;\n    case \"GLITCH\":\n      modules.whitePrint(ctx, canvas);\n      modules.textPrint(ctx,canvas,cmd.property);\n      setTimeout(()=>{\n        modules.whitePrint(ctx, canvas);\n      },500)\n      speakVoice(cmd.cmd)\n      break;\n    case \"BROWSER\":\n      window.open('https://instagram.com', '_blank', 'width=800,height=600');\n      speakVoice(cmd.cmd)\n    case \"PREV\":\n      pastPresent(cmd[\"property\"]);\n      break;\n    case \"STOP\":\n      stop();\n      videoStop();\n      setTimeout(()=>{\n        modules.whitePrint(ctx, canvas);\n      }, 500);\n      //speakVoice(cmd.cmd)\n      break;\n    case \"NUMBER\":\n      modules.whitePrint(ctx, canvas)\n      modules.textPrint(ctx, canvas, String(cmd.property))\n      setTimeout(()=>{\n        modules.whitePrint(ctx, canvas);\n      },1000)\n      break;\n    case \"CTRL\":\n      console.log(cmd[\"property\"]);\n      if($('#ctrl').size()){\n        $('#ctrl').remove();\n      } else {\n        let addHTML = modules.ctrlView(cmd[\"property\"]);\n        $('#wrapper').before('<div id=\"ctrl\">' + addHTML + '</div>');\n      }\n      speakVoice(\"CONTROL\")\n      break;\n    case \"INSTRUCTION\":\n      videoStop();\n      modules.whitePrint(ctx, canvas);\n      modules.textPrint(ctx, canvas, cmd[\"property\"][\"text\"]);\n      if(client != \"inside\") alertPlay();\n      mode = \"instruction\"\n      setTimeout(()=>{\n        modules.whitePrint(ctx, canvas);\n        mode = \"none\"\n      }, cmd[\"property\"][\"duration\"]);\n      speakVoice(cmd.property.text)\n      break;\n    default:\n      console.log(cmd[\"cmd\"]);\n      for(let key in streamList){\n        if(key === cmd[\"cmd\"]){\n          // console.log(cmd[\"cmd\"]);\n          videoMode.mode = \"chat\";\n          modules.whitePrint(ctx, canvas);\n          modules.textPrint(ctx, canvas, cmd[\"cmd\"]);\n          setTimeout(()=> {\n            modules.whitePrint(ctx, canvas);\n          },800);\n        }\n      }\n      speakVoice(cmd.cmd)\n      break;\n\n  }\n  strings = \"\";\n  stringsClient = \"\";\n}\n/*\nconst munouNoUnmei = (data) =>{\n  modules.whitePrint(ctx, canvas);\n  console.log(data);\n  let speed = 0;\n  if(room = \"surface\"){\n    speed = (Math.round((data[\"speed\"] - 0.88) * 1000) / 1000);\n  } else {\n    speed = (Math.round((data[\"speed\"] - 0.75) * 1000) / 1000);\n  }\n  //data = Math.round(data * 1000) / 1000;\n  modules.textPrint(ctx, canvas, data[\"room\"] + \": \" + String(speed) + \"m/s\");\n  let freqVal = 110;\n  let cT = audioContext.currentTime;\n  if(data[\"speed\"] < 4) {\n    freqVal = 110 * Math.pow(2,data[\"speed\"] * 2 / 12);  //1m/s^21\n  } else if(data < 8) {\n    freqVal = 110 * Math.pow(2,(data[\"speed\"]-1) * 2 /12 + 1 / 12);  //1m/s^21\n  } else {\n    freqVal = 110 * Math.pow(2,(data[\"speed\"] - 2) * 2 /12 + 2 / 12);  //1m/s^21\n  }\n  if(munouGain.gain.value === 0) munouGain.gain.value = 0.7;\n  munouOsc.frequency.setTargetAtTime(freqVal,cT,0.3);\n}\n*/\n\nconst stop = () => {\n  oscGain.gain.setTargetAtTime(0,0,0.01);\n  feedbackGain.gain.setTargetAtTime(0,0,0.01)\n  noiseGain.gain.setTargetAtTime(0,0,0.01)\n  bassGain.gain.setTargetAtTime(0,0,0.01)\n  //munouGain.gain.value = 0;\n  bassFlag = false;\n  modules.whitePrint(ctx, canvas);\n//  modules.textPrint(ctx, canvas, \"\");\n  mode = \"none\";\n  modules.textPrint(ctx, canvas, \"STOP\");\n  stopRhythm();\n}\n\nconst videoStop = () => {\n  switch (videoMode.mode) {\n    case \"chunkEmit\":\n      break;\n    case \"beforePlay\":\n    case \"beforeBuff\":\n      streamBuffer = []\n    default:\n      videoMode.mode = \"none\";\n      break;\n  }\n}\n\n\nconst pastPresent = (status) =>{\n  // console.log(status);\n  for(let key in status){\n    if(key === \"SINEWAVE\" && status[key]){\n      doCmd({\"cmd\":key, \"property\": Number(status[key])});\n    } else if(key === \"SECBEFORE\" && status[key]){\n      videoMode.mode = \"pastPlay\";\n    } else if(status[key]){\n      doCmd({\"cmd\":key});\n    }\n  }\n}\n\nconst playVideo = (video) => {\n//  whitePrint();\n  image = new Image();\n  image.src = video;\n  var wdth;\n  var hght;\n  wdth = $(window).width();\n  hght = (wdth * 3) / 4;\n\n  image.onload = function(){\n    receive_ctx.drawImage(image, 0, 0, wdth, hght);\n  }\n}\n\nconst lapseInterval = 120000;\nlet setLapse;\n\nconst timeLapse = ()=>{\n  setLapse = setInterval(() => {\n      timelapseFlag = true;\n  }, lapseInterval);\n}\n\nconst stopLapse = ()=>{\n  clearInterval(setLapse);\n}\n\n/*\nconst emitInterval = 120000;\nsetInterval(() => {\n  // if(videoMode.mode === \"none\"){\n    // console.log(\"\");\n    timelapseFlag = true;\n  // }\n}, emitInterval);\n*/\n\n//ctrlView ctrl\n\n$(function() {\n  $(document).on('change', '.range', function(){\n    console.log(\"range change\");\n    let ctrlCmd;\n    let ctrlProperty;\n    if($(this).attr('id') === \"CHATRATE\"){\n      ctrlCmd = \"CHATRATE\"\n      ctrlProperty ={\n        \"target\": $(this).attr('name'),\n        \"val\" : $(this).val()\n      };\n      let test ='label[name=\"' + ctrlProperty[\"target\"] + '\"]#CHATRATELabel';\n      console.log(test);\n      $('label[name=\"' + ctrlProperty[\"target\"] + '\"]#CHATRATELabel').text(String(ctrlProperty[\"val\"]));\n    } else if($(this).attr('id').match(/^LATENCY/) || $(this).attr('id').match(/^RATE/) ) {\n      let val = $(this).val();\n      let targetArr = $(this).attr('id').split(\"_\");\n      if(targetArr[0] === \"LATENCY\") val = val * 1000;\n      ctrlCmd = targetArr[0];\n      ctrlProperty = {\n        \"target\": $(this).attr('name'),\n        \"streamType\": targetArr[1],\n        \"val\": val\n      }\n      $('#' + targetArr[0] + 'Label').text(val);\n      setTimeout(()=>{\n        $('#' + targetArr[0] + 'Label').text(targetArr[0]);\n      },2000);\n    } else {\n      ctrlCmd = $(this).attr('name');\n      ctrlProperty = {\n        \"target\" : $(this).attr('id'),\n        \"val\" : $(this).val()\n      };\n      $('#' + ctrlCmd + ctrlProperty[\"target\"] + 'Label').text(String(ctrlProperty[\"val\"]));\n    }\n    console.log(ctrlCmd);\n    console.log(ctrlProperty);\n    socket.emit('cmdFromCtrl',{\n      \"cmd\": ctrlCmd,\n      \"property\": ctrlProperty\n    });\n  });\n});\n\n$(function() {\n  $(document).on('change', '.route', function(){\n    let property = {\n      \"target\" : $(this).attr('name'),\n      \"stream\" : $(this).attr('id').split(\"_\")[0],\n      \"val\" : $(this).prop('checked')\n    };\n    console.log(property);\n    socket.emit('cmdFromCtrl',{\n      \"cmd\": $(this).attr('id').split(\"_\")[1],\n      \"property\": property\n    });\n  });\n});\n\nconst funcToBase64 = () =>{\n  //console.log(buffer);\n  let bufferContext = buffer.getContext('2d');\n  buffer.width = video.videoWidth;\n  buffer.height = video.videoHeight;\n  bufferContext.drawImage(video, 0, 0);\n  //return buffer.toDataURL(\"image/webp\");\n  return buffer.toDataURL(\"image/jpeg\");\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/client.js"],"sourceRoot":""}